<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/node-mongodb-native/2.0/img/favicon.png">

    <title>Driver Enterprise Features</title>

    <link href="/node-mongodb-native/2.0/css/bootstrap-theme.css" rel="stylesheet">
    <link href="/node-mongodb-native/2.0/assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="/node-mongodb-native/2.0/css/style.css" rel="stylesheet">
    <link href="/node-mongodb-native/2.0/css/style-responsive.css" rel="stylesheet" />
    <link href="/node-mongodb-native/2.0/css/monokai_sublime.css" rel="stylesheet" />

  </head>

  <body>
  
  <section id="container" class="">

      
      <header class="header black-bg">
            <div class="toggle-nav">
                <i class="fa fa-bars"></i>
                <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
            </div>

            
            <a href="http://mongodb.github.io/node-mongodb-native/2.0" class="logo"><img src="/node-mongodb-native/2.0/img/logo-mongodb-header.png" style="height:40px;"></a>

            
            <div class="top-nav notification-row">
                
                <div class="hidden-xs nav-github pull-right">
                    <span rel="show-github" data-user="mongodb" data-repo="node-mongodb-native"></span>
                    <a href='http://travis-ci.org/mongodb/node-mongodb-native'><img src='https://secure.travis-ci.org/mongodb/node-mongodb-native.png'/><a>
                </div>
            </div>

            <div class="nav title-row" id="top_menu">
                <h1 class="nav top-menu"> MongoDB 2.0.0 Driver </h1>
            </div>
      </header>
      


<aside>
    <div id="sidebar"  class="nav-collapse ">
        
        <ul class="sidebar-menu">
          
          
              
                <li>
                <a class="" href="http://mongodb.github.io/node-mongodb-native/">
                    <i class='fa fa-file-text'></i>
                    
                    <span>driver portal</span>
                </a>
              
              </li>
          
              
                <li>
                <a class="" href="/node-mongodb-native/2.0/api/">
                    <i class='fa fa-file-text'></i>
                    
                    <span>API Docs</span>
                </a>
              
              </li>
          
              
                <li>
                <a class="" href="http://mongodb.github.com/node-mongodb-native/core">
                    <i class='fa fa-file-text'></i>
                    
                    <span>1.1 Core Docs</span>
                </a>
              
              </li>
          
              
                <li>
                <a class="" href="http://mongodb.org">
                    <i class='fa fa-file-text'></i>
                    
                    <span>Mongo DB Docs</span>
                </a>
              
              </li>
          
              

            <li class="sub-menu">
            <a href="javascript:;" class="">
                <i class='fa fa-gift'></i>
                
                <span>about driver</span>
                <span class="menu-arrow fa fa-angle-right"></span>
            </a>
                <ul class="sub">
                    
                    <li><a href="/node-mongodb-native/2.0/meta/license/"> License </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/meta/release-notes/"> Release Notes </a> </li>
                    
                </ul>
              
              </li>
          
              

            <li class="sub-menu active">
            <a href="javascript:;" class="">
                <i class='fa fa-book'></i>
                
                <span>tutorials</span>
                <span class="menu-arrow fa fa-angle-down"></span>
            </a>
                <ul class="sub open">
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/connecting/"> Connecting To MongoDB </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/connection_failures/"> Connection Failures </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/urls/"> Connection URI </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/crud_operations/"> CRUD Operations </a> </li>
                    
                    <li class="active"><a href="/node-mongodb-native/2.0/tutorials/enterprise_features/"> Driver Enterprise Features </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/aggregation/"> Aggregation </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/streams/"> Streams </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/gridfs/"> GridFS </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/logging/"> Logging </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/objectid/"> ObjectId </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/tracing/"> Tracing </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/tutorials/changes-from-1.0/"> Migrating to 2.X </a> </li>
                    
                </ul>
              
              </li>
          
              

            <li class="sub-menu">
            <a href="javascript:;" class="">
                <i class='fa fa-book'></i>
                
                <span>articles</span>
                <span class="menu-arrow fa fa-angle-right"></span>
            </a>
                <ul class="sub">
                    
                    <li><a href="/node-mongodb-native/2.0/articles/node_knockout_article_1/"> Node Knockout, Basics </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/articles/node_knockout_article_2/"> Node Knockout, GridFS </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/articles/node_knockout_article_3/"> Node Knockout, GEO </a> </li>
                    
                </ul>
              
              </li>
          
              

            <li class="sub-menu">
            <a href="javascript:;" class="">
                <i class='fa fa-group'></i>
                
                <span>community</span>
                <span class="menu-arrow fa fa-angle-right"></span>
            </a>
                <ul class="sub">
                    
                    <li><a href="/node-mongodb-native/2.0/community/mailing-list/"> Mailing List </a> </li>
                    
                    <li><a href="/node-mongodb-native/2.0/community/contributing/"> Contributing </a> </li>
                    
                </ul>
              
              </li>
          
            <li> <a href="https://jira.mongodb.org/browse/NODE" target="blank"><i class='fa fa-life-ring'></i>Issues & Help</a> </li>
            
              <li><a href="https://github.com/mongodb/node-mongodb-native/docs/content/tutorials/enterprise_features.md" target="blank"><i class='fa fa-edit'></i> Refine this Page</a> </li>
            
            <li><a href='https://gitter.im/mongodb/node-mongodb-native?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge'><img src='https://badges.gitter.im/Join Chat.svg'/></a></li>
        </ul>
        
    </div>
</aside>



      
      <section id="main-content">
          <section class="wrapper">

              
                  
                      
                      
                          
                          
                          
                      
                      
                  
              

              <div class="row">
                  <div class="col-md-1">
                      
                      
                      <a class="navigation prev" href="../../tutorials/changes-from-1.0">
                      <i class="fa fa-angle-left"></i>
                      </a>
                      
                      
                  </div>
                <div class="col-md-10">
                    <section class="panel">
                          
                              
                          
                    <div class="panel-body">



<h1 id="enterprise-driver-features:6e3614dc6c70ae01cdc1669aeb0efb13">Enterprise Driver Features</h1>

<p>This tutorial covers aspects of the driver related to the Subscription version of MongoDB that includes SSL, X509, ldap and kerberos support.</p>

<h2 id="connecting-using-ssl:6e3614dc6c70ae01cdc1669aeb0efb13">Connecting using SSL</h2>

<h3 id="no-validation-of-certificate-chain:6e3614dc6c70ae01cdc1669aeb0efb13">No validation of certificate chain</h3>

<p>If the server does not perform any validation of the certificate chain connecting to the server is straightforward.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient;

MongoClient.connect(&quot;mongodb://localhost:27017/test?ssl=true&quot;, function(err, db) {
  db.close();
});

</code></pre>

<h3 id="driver-should-validate-server-certificate:6e3614dc6c70ae01cdc1669aeb0efb13">Driver should validate Server certificate</h3>

<p>If the server presents a certificate that we wish to validate client side we need a couple more parameters.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient
  , fs = require('fs');

// Read the certificate authority
var ca = [fs.readFileSync(__dirname + &quot;/ssl/ca.pem&quot;)];

// Connect validating the returned certificates from the server
MongoClient.connect(&quot;mongodb://localhost:27017/test?ssl=true&quot;, {
  server: {
      sslValidate:true
    , sslCA:ca
  }
}, function(err, db) {
  db.close();
});

</code></pre>

<h3 id="driver-should-validate-server-certificate-and-present-valid-certificate:6e3614dc6c70ae01cdc1669aeb0efb13">Driver should validate Server certificate and present valid Certificate</h3>

<p>If the server is configured to perform certificate validation we need to pass a certificate through the driver as well as verify the one retrieved. In this case our certificate password is <code>10gen</code>.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient
  , fs = require('fs');

// Read the certificate authority
var ca = [fs.readFileSync(__dirname + &quot;/ssl/ca.pem&quot;)];
var cert = fs.readFileSync(__dirname + &quot;/ssl/client.pem&quot;);
var key = fs.readFileSync(__dirname + &quot;/ssl/client.pem&quot;);

// Connect validating the returned certificates from the server
MongoClient.connect(&quot;mongodb://localhost:27017/test?ssl=true&quot;, {
  server: {
      sslValidate:true
    , sslCA:ca
    , sslKey:key
    , sslCert:cert
    , sslPass:'10gen'
  }
}, function(err, db) {
  db.close();
});

</code></pre>

<h2 id="connecting-using-x509:6e3614dc6c70ae01cdc1669aeb0efb13">Connecting using X509</h2>

<p>X509 is a certification validation process similar to normal SSL validation but it also includes specific user information that can be used for authorization. Connecting is very similar to the previous SSL examples.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient
  , fs = require('fs');

// Read the cert and key
var cert = fs.readFileSync(__dirname + &quot;/ssl/x509/client.pem&quot;);
var key = fs.readFileSync(__dirname + &quot;/ssl/x509/client.pem&quot;);

// User name
var userName = &quot;CN=client,OU=kerneluser,O=10Gen,L=New York City,ST=New York,C=US&quot;;

// Connect using the MONGODB-X509 authentication mechanism
MongoClient.connect(f('mongodb://%s@server:27017/test?authMechanism=%s&amp;ssl=true'
    , encodeURIComponent(userName), 'MONGODB-X509'), {
  server: {
      sslKey:key
    , sslCert:cert
  }
}, function(err, db) {
  db.close();
});

</code></pre>

<h2 id="connecting-using-ldap:6e3614dc6c70ae01cdc1669aeb0efb13">Connecting using LDAP</h2>

<p>The LDAP support in the subscription version of MongoDB allows for integrating against corporate LDAP server to manage authentication and authorization. To connect using LDAP we need to do the following.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient
  , f = require('util').format;

// LDAP credentials
var server = &quot;ldaptest.someserver.com&quot;;
var user = &quot;drivers-team&quot;;
var pass = &quot;mongo0x$server&quot;;

// Url
var url = f(&quot;mongodb://%s:%s@%s/test?authMechanism=PLAIN&amp;maxPoolSize=1&quot;, user, pass, server);

// Connect using ldap credentials
MongoClient.connect(url, function(err, db) {
  db.close();
});

</code></pre>

<h2 id="connecting-using-kerberos:6e3614dc6c70ae01cdc1669aeb0efb13">Connecting using Kerberos</h2>

<p>The subscription version of MongoDB support kerberos authentication and authorization support using SSPI under windwos and GSAPI under unix. To connect with kerberos (this example expects there to be a valid kerberos ticket for the user).</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient;
  , f = require('util').format;

// KDC Server
var server = &quot;ldaptest.10gen.cc&quot;;
var principal = &quot;drivers@LDAPTEST.10GEN.CC&quot;;
var urlEncodedPrincipal = encodeURIComponent(principal);

// Url
var url = f(&quot;mongodb://%s@%s/kerberos?authMechanism=GSSAPI&amp;gssapiServiceName=mongodb&quot;, urlEncodedPrincipal, server);

// Connect using kerberos details
MongoClient.connect(url, function(err, db) {
  db.close();
});

</code></pre>

<p>You can also pass in password credentials for a kerberos connection, this is useful on windows if you don&rsquo;t have a security domain set up.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient;
  , f = require('util').format;

// KDC Server
var server = &quot;ldaptest.10gen.cc&quot;;
var principal = &quot;drivers@LDAPTEST.10GEN.CC&quot;;
var urlEncodedPrincipal = encodeURIComponent(principal);

// Url
var url = f(&quot;mongodb://%s:%s@%s/kerberos?authMechanism=GSSAPI&amp;maxPoolSize=1&quot;, urlEncodedPrincipal, pass, server);

// Connect using kerberos details
MongoClient.connect(url, function(err, db) {
  db.close();
});

</code></pre>

                      
                      <div id="disqus_thread"></div>
                      <script type="text/javascript">
                           
                          var disqus_shortname = 'nodejsmongodbdriver'; 

                           
                          (function() {
                              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                          })();
                      </script>
                      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                      
                    </div>
                    </section>
                </div>
                <div class="col-md-1">
                    
                    
                    <a class="navigation next" href="../../tutorials/connecting">
                        <i class="fa fa-angle-right"> </i>
                    </a>
                    
                    
                </div>
              </div>
              
          </section>
      </section>
     
  </section>
  
    
    <script src="/node-mongodb-native/2.0/js/jquery-2.1.1.min.js"></script>
    <script src="/node-mongodb-native/2.0/js/jquery.scrollTo.min.js"></script>
    <script src="/node-mongodb-native/2.0/js/bootstrap.min.js"></script>
    
    <script src="/node-mongodb-native/2.0/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/node-mongodb-native/2.0/js/scripts.js"></script>
    <script async defer id="github-bjs" src="/node-mongodb-native/2.0/js/buttons.js"></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29229787-1', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>

